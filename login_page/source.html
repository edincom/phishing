<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Connexion — Compte Microsoft</title>

    <style>
      :root {
        --bg-url: url("./ecam_background.jpeg");
        --overlay-color: rgba(
          6,
          18,
          41,
          0.45
        ); /* couleur foncée semi-transparente pour contraste */
        --card-bg: rgba(
          255,
          255,
          255,
          0.85
        ); /* carte légèrement transparente */
        --card-shadow: 0 8px 24px rgba(2, 6, 23, 0.16);
        --accent: #0067b8;
      }

      /* Full-screen background */
      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        font-family: "Segoe UI", sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
        background-image: var(--bg-url);
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        position: relative;
        padding: 40px;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Dark overlay to keep text readable */
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.3) 0%,
          rgba(0, 0, 0, 0.52) 100%
        );
        pointer-events: none;
        z-index: 0;
      }

      /* Optional: subtle pattern / vignette for brand feel */
      body::after {
        content: "";
        position: fixed;
        inset: 0;
        background: radial-gradient(
            1000px 600px at 10% 20%,
            rgba(255, 255, 255, 0.03),
            transparent 10%
          ),
          radial-gradient(
            800px 500px at 90% 80%,
            rgba(0, 0, 0, 0.05),
            transparent 12%
          );
        z-index: 0;
        pointer-events: none;
      }

      /* Card (form) */
      #container {
        width: 360px;
        max-width: calc(100% - 48px);
        background: var(--card-bg);
        border-radius: 6px;
        box-shadow: var(--card-shadow);
        position: relative;
        z-index: 1; /* above overlay */
        overflow: hidden;
        /* glass effect on supported browsers */
        backdrop-filter: blur(6px) saturate(120%);
        -webkit-backdrop-filter: blur(6px) saturate(120%);
      }

      /* header paddings and logo */
      #header {
        padding: 36px 36px 18px 36px;
      }
      #header img {
        width: 95px;
        display: block;
        margin-bottom: 28px;
      }

      h2 {
        margin: 0 0 6px 0;
        font-size: 22px;
        font-weight: 600;
        color: #111;
      }

      p {
        margin: 0;
        color: #333;
        font-size: 14px;
      }

      input {
        width: 100%;
        padding: 10px 8px;
        margin-top: 16px;
        font-size: 15px;
        border: none;
        border-bottom: 1px solid #8b8b8b;
        outline: none;
        background: transparent;
        color: #111;
      }

      input::placeholder {
        color: #8b8b8b;
      }

      input:focus {
        border-bottom: 2px solid var(--accent);
      }

      .error {
        color: #b10000;
        font-size: 13px;
        margin-top: 8px;
        display: none;
      }

      .link {
        margin-top: 14px;
        font-size: 14px;
        color: var(--accent);
        cursor: pointer;
      }

      #footer {
        background: rgba(
          0,
          0,
          0,
          0
        ); /* keep transparent so card looks unified */
        padding: 14px 36px 28px 36px;
        text-align: right;
      }

      button {
        background: var(--accent);
        color: #fff;
        border: none;
        padding: 10px 22px;
        font-size: 15px;
        border-radius: 3px;
        cursor: pointer;
      }
      button:hover {
        background: #005a9e;
      }

      #showPassword {
        margin-top: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: #333;
      }

      /* Responsive adjustments */
      @media (max-width: 480px) {
        #header {
          padding: 28px 18px 12px 18px;
        }
        #footer {
          padding: 12px 18px 20px 18px;
        }
        #header img {
          width: 84px;
          margin-bottom: 22px;
        }
      }

      /* Accessible contrast fallback: if image fails, use this color */
      .fallback-bg {
        background-color: #0b2a4a; /* organisation color fallback */
      }
    </style>
  </head>

  <body>
    <div id="container" role="main" aria-labelledby="signin-title">
      <!-- Écran EMAIL -->
      <div id="emailScreen">
        <div id="header">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg"
            alt="Logo de l'organisation"
          />
          <h2 id="signin-title">Se connecter</h2>
          <p>
            Entrez votre adresse e-mail, numéro de téléphone ou identifiant
            Skype.
          </p>

          <input
            id="emailInput"
            type="text"
            placeholder="Email, téléphone ou Skype"
            aria-label="Adresse e-mail"
          />
          <div id="emailError" class="error" role="alert">
            Veuillez entrer un identifiant valide.
          </div>
        </div>

        <div id="footer">
          <button onclick="goToPassword()">Suivant</button>
        </div>
      </div>

      <!-- Écran PASSWORD -->
      <div id="passwordScreen" style="display: none">
        <div id="header">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg"
            alt="Logo"
          />
          <h2 id="emailDisplay"></h2>
          <p>Entrez votre mot de passe.</p>

          <input
            id="passwordInput"
            type="password"
            placeholder="Mot de passe"
            aria-label="Mot de passe"
          />
          <div id="passwordError" class="error" role="alert">
            Veuillez entrer un mot de passe.
          </div>

          <div id="showPassword">
            <input
              type="checkbox"
              onclick="togglePassword()"
              id="chkShow"
            /><label for="chkShow">Afficher le mot de passe</label>
          </div>

          <div class="link" onclick="backToEmail()">
            ← Utiliser un autre compte
          </div>
        </div>

        <div id="footer">
          <button onclick="submitLogin()">Connexion</button>
        </div>
      </div>
    </div>

    <script>
      /* Basic flow (unchanged) */
      function goToPassword() {
        const email = document.getElementById("emailInput").value.trim();
        const error = document.getElementById("emailError");
        if (!email) {
          error.style.display = "block";
          return;
        }
        error.style.display = "none";
        document.getElementById("emailDisplay").innerText = email;
        document.getElementById("emailScreen").style.display = "none";
        document.getElementById("passwordScreen").style.display = "block";
      }
      function backToEmail() {
        document.getElementById("passwordScreen").style.display = "none";
        document.getElementById("emailScreen").style.display = "block";
      }
      function togglePassword() {
        const input = document.getElementById("passwordInput");
        input.type = input.type === "password" ? "text" : "password";
      }
      function submitLogin() {
        const email = document.getElementById("emailDisplay").innerText;
        const password = document.getElementById("passwordInput").value.trim();
        const error = document.getElementById("passwordError");
        if (!password) {
          error.style.display = "block";
          return;
        }
        error.style.display = "none";
        alert("Email : " + email + "\nPassword : " + password);
      }

      /* Optional: dynamic background selection by query param or host
       Usage examples:
         index.html?bg=marketing  -> will use mapping below
         or automatic per-host using location.hostname
    */
      (function () {
        const mapping = {
          marketing: "bg-marketing.jpg",
          office: "bg-office.jpg",
          default: "bg-signin.jpg",
        };

        const params = new URLSearchParams(location.search);
        const key = params.get("bg");

        const img = key && mapping[key] ? mapping[key] : null;

        if (img) {
          try {
            document.documentElement.style.setProperty(
              "--bg-url",
              `url('${img}')`
            );
          } catch (e) {}
        }

        // Example: per-host backgrounds (uncomment and adapt)
        // if (location.hostname.endsWith('eu.example.com')) {
        //   document.documentElement.style.setProperty('--bg-url', "url('bg-eu.jpg')");
        // }

        // If background fails (image 404), keep a fallback solid color:
        const urlVal = getComputedStyle(document.documentElement)
          .getPropertyValue("--bg-url")
          .trim();
        if (!urlVal || urlVal === 'url("")') {
          document.body.classList.add("fallback-bg");
        }
      })();
    </script>
  </body>
</html>
